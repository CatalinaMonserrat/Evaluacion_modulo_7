# Tienda Sakura ‚Äì Gesti√≥n de Productos con Django y PostgreSQL  

Aplicaci√≥n web desarrollada como parte de la **Evaluaci√≥n del M√≥dulo 7** (Talento Digital).  
Permite gestionar productos, categor√≠as y etiquetas con un sistema CRUD completo, utilizando el ORM de Django y conexi√≥n a **PostgreSQL**.  

---

## Descripci√≥n general  

La aplicaci√≥n gestiona una tienda tem√°tica de anime donde se administran **productos, categor√≠as y etiquetas**.  
Incluye relaciones:  
- **Muchos a Uno** ‚Üí `Producto ‚Üí Categoria`  
- **Muchos a Muchos** ‚Üí `Producto ‚Üî Etiqueta`  
- **Uno a Uno** ‚Üí `Producto ‚Üí DetalleProductos` (dimensiones y peso)  

---

## Instalaci√≥n  

```bash
git clone https://github.com/tuusuario/tienda-sakura.git
cd aplicacion
python -m venv myenv
myenv\Scripts\activate
pip install django psycopg2-binary
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver
```

Accede a:
- http://127.0.0.1:8000 ‚Üí aplicaci√≥n  
- http://127.0.0.1:8000/admin ‚Üí panel de administraci√≥n  

---

## üñºÔ∏è Interfaz del sistema

## üñ•Ô∏è Interfaz del Sistema

| Vista | Descripci√≥n | Imagen |
|--------|--------------|--------|
| **Inicio** | Men√∫ principal de navegaci√≥n | ![Inicio](img/inicio.png) |
| **Lista de productos** | Tabla con acciones CRUD | ![Lista de productos](img/lista_productos.png) |
| **Crear producto** | Formulario de creaci√≥n | ![Crear producto](img/crear_producto.png) |
| **Detalle de producto** | Informaci√≥n completa | ![Detalle producto](img/detalle_producto.png) |
| **Editar producto** | Formulario precargado | ![Editar producto](img/editar_producto.png) |
| **Eliminar producto** | Confirmaci√≥n de borrado | ![Eliminar producto](img/eliminar_producto.png) |
| **Categor√≠as** | CRUD de categor√≠as | ![Categor√≠as](img/lista_categorias.png) |
| **Etiquetas** | CRUD de etiquetas | ![Etiquetas](img/lista_etiquetas.png) |
| **Login** | Vista de inicio de sesi√≥n | ![Login](img/login.png) |


## Modelos principales  

```python
class Categoria(models.Model):
    nombre = models.CharField(max_length=255, unique=True)

class Etiqueta(models.Model):
    nombre = models.CharField(max_length=255, unique=True)

class Producto(models.Model):
    nombre = models.CharField(max_length=255)
    descripcion = models.TextField()
    precio = models.DecimalField(max_digits=10, decimal_places=2)
    stock = models.PositiveIntegerField(default=0)
    categoria = models.ForeignKey(Categoria, on_delete=models.PROTECT, related_name='productos')
    etiquetas = models.ManyToManyField(Etiqueta, related_name='productos', blank=True)

class DetalleProductos(models.Model):
    producto = models.OneToOneField(Producto, on_delete=models.CASCADE, related_name='detalle')
    peso_kg = models.DecimalField(max_digits=6, decimal_places=2, null=True, blank=True)
    alto_cm = models.DecimalField(max_digits=6, decimal_places=2, null=True, blank=True)
    ancho_cm = models.DecimalField(max_digits=6, decimal_places=2, null=True, blank=True)
    largo_cm = models.DecimalField(max_digits=6, decimal_places=2, null=True, blank=True)
```

---

## Consultas ORM realizadas  

Ejecutadas desde la shell de Django (`python manage.py shell`) utilizando `filter()`, `exclude()`, `annotate()` y `Q()`.  

### B√∫squedas b√°sicas
```python
# Por nombre (case-insensitive)
Producto.objects.filter(nombre__icontains="naruto")

# Por categor√≠a
cat = Categoria.objects.get(nombre="Mangas")
Producto.objects.filter(categoria=cat)

# Por nombre o descripci√≥n
from django.db.models import Q
Producto.objects.filter(Q(nombre__icontains="tanjiro") | Q(descripcion__icontains="demon"))
```
![B√∫squedas b√°sicas](img/B√∫squeda_basicas.png)

### Comparaciones y orden
```python
# Mayores a un valor
Producto.objects.filter(precio__gt=15000)

# Rango de precios
Producto.objects.filter(precio__gte=8000, precio__lte=25000)

# Ordenar
Producto.objects.order_by("-precio", "nombre")[:5]
```
![Precios y comparaciones](img/Precios_comparaciones.png)

### Relaciones Muchos-a-Muchos
```python
shonen = Etiqueta.objects.get(nombre="Shonen")

# Productos con una etiqueta espec√≠fica
Producto.objects.filter(etiquetas=shonen).distinct()

# Productos con varias etiquetas (que tengan TODAS)
Producto.objects.filter(etiquetas__in=[shonen]).distinct()

# Productos que tengan al menos UNA etiqueta
Producto.objects.filter(etiquetas__in=[shonen, fantasia]).distinct()
```
![Consultas M2M](img/consultas_M2M.png)

### Consultas con exclude()
```python
# Excluir rango de precios
Producto.objects.exclude(precio__gte=8000, precio__lte=25000)

# Excluir nulos (sin descripci√≥n)
Producto.objects.exclude(descripcion__isnull=True).exclude(descripcion__exact="")

# Combinar filter + exclude
Producto.objects.filter(categoria=cat).exclude(nombre__icontains="edici√≥n limitada")

# Excluir varias categor√≠as
Producto.objects.exclude(categoria__nombre__in=["Posters", "Accesorios"])
```
![Consultas exclude](img/Consultas_exclude.png)

###  Combinaciones con Q() y condiciones l√≥gicas
```python
from django.db.models import Q
Producto.objects.filter(
    Q(nombre__icontains="tanjiro") | Q(descripcion__icontains="demon"),
    precio__gt=10000
)
```
![filter Q combinaciones](img/filter0_Q(combinaciones).png)

### Consultas con anotaciones y agregaciones
```python
from django.db.models import Count, Avg, Min, Max

# Total de productos por categor√≠a
Producto.objects.values("categoria__nombre").annotate(total=Count("id")).order_by("-total")

# Promedio, m√≠nimo y m√°ximo por categor√≠a
Producto.objects.values("categoria__nombre").annotate(
    prom=Avg("precio"),
    minimo=Min("precio"),
    maximo=Max("precio")
)
```
![Consultas annotate](img/consultas_annotate.png)

---

## Seguridad

- Formularios protegidos con `{% csrf_token %}`  
- Vistas con `@login_required`  
- Middleware de seguridad activado  
- Django Admin habilitado para gesti√≥n de modelos  

---

## Rutas principales  

```python
urlpatterns = [
    path('', views.index, name='index'),
    path('productos/', views.lista_productos, name='lista_productos'),
    path('productos/crear/', views.crear_producto, name='crear_producto'),
    path('productos/<int:id>/', views.detalle_producto, name='detalle_producto'),
    path('productos/<int:id>/editar/', views.editar_producto, name='editar_producto'),
    path('productos/<int:id>/eliminar/', views.eliminar_producto, name='eliminar_producto'),
    path('categorias/', views.lista_categorias, name='lista_categorias'),
    path('etiquetas/', views.lista_etiquetas, name='lista_etiquetas'),
]
```

---

## Licencia

Proyecto acad√©mico ‚Äî Catalina Villegas ‚Äî Talento Digital 2025.
